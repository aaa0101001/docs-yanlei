# RabbitMQ 怎么样保证消息不丢失

## 1. 消息丢失的原因

### 1.1 生产者丢失

生产者丢失消息的原因有：

1. 网络问题，如：
    - 网络闪断，导致未发送完的消息丢失
    - 网络超时，导致未发送完的消息丢失
2. 消息被服务端丢弃
    - 消息队列已满，导致未发送完的消息丢失
    - 消息队列拒绝策略，导致未发送完的消息丢失

### 1.2 消费者丢失

消费者丢失消息的原因有：

1. 消息处理失败，导致消息重新入队，重新入队后，消费者会重新消费消息
2. 消息处理成功，但是消费者消费消息失败，导致消息丢失

## 2. 如何保证消息不丢失

### 2.1 生产者丢失

#### 2.1.1 消息确认机制

生产者发送消息到消息队列后，需要等待消息被服务端确认，确认后，消息才算是发送成功。

#### 2.1.2 持久化

消息队列的持久化，可以避免消息服务端重启后，消息丢失。

#### 2.1.3 消息回调机制

生产者发送消息到消息队列后，需要等待消息被服务端确认，确认后，消息才算是发送成功。







